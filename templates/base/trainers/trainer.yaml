-- extends 'trainers/base_trainer.yaml'
-- block trainer_meta_config
    == super()
    -- set trainer_def.name = "forgather.ml.trainer.Trainer"
    -- set trainer_def.description = "A lightweight, extensible trainer; does not support multiple GPUs"
-- endblock trainer_meta_config


-- block trainer_constructor
.define: &trainer !singleton:forgather.ml.trainer:Trainer@trainer
    model: *model
    args: !singleton:forgather.ml.trainer_types:TrainingArguments@trainer_args
        <<: *trainer_args
    data_collator: *data_collator
    train_dataset: *train_dataset
    eval_dataset: *eval_dataset
    tokenizer: *tokenizer
    callbacks: *trainer_callbacks
<< endblock trainer_constructor