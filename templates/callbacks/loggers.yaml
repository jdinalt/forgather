-- extends 'callbacks/base_callbacks.yaml'

-- block callback_dependencies
# Experiment tracking: Tensorboard SummaryWriter
.define: &summary_writer !callable:torch.utils.tensorboard:SummaryWriter
    - "{{ ns.logging_dir }}"

    -- block experiment_info
# Additional data to record to experiment loggers
.define: &experiment_info
    date: "{{ utcisotime() }}"
    name: "{{ ns.config_name }}"
    description: "{{ ns.config_description }}"
    config: !key "pp_config"
    versions: {{ versions }}
    << endblock experiment_info
<< endblock callback_dependencies
    

-- block callback_list
.define: &trainer_callbacks
    # Log all training output to JSON
    - !callable:aiws.json_logger:JsonLogger
        <<: *experiment_info
    # Log configuration and metrics to Tensorboard file
    - !callable:aiws.tb_logger:TBLogger
        args: [ *summary_writer ]
        kwargs:
            <<: *experiment_info
<< endblock callback_list