-- extends 'callbacks/base_callbacks.yaml'

-- block callback_dependencies
# Experiment tracking: Tensorboard SummaryWriter
.define: &summary_writer !callable:torch.utils.tensorboard:SummaryWriter
    - "{{ ns.LOGGING_DIR }}"

    -- block experiment_info
# Additional data to record to experiment loggers
.define: &experiment_info
    date: "{{ utcnow() }}"
    name: "{{ ns.EXPERIMENT_NAME }}"
    description: "{{ ns.EXPERIMENT_DESCRIPTION }}"
    config: !callable:pp_config
    versions: {{ versions }}
    << endblock experiment_info
<< endblock callback_dependencies
    

-- block callback_list
.define: &trainer_callbacks
    - !callable:aiws.default_callbacks:InfoCallback
    # Log training metrics to JSON fiie.
    - !callable:aiws.json_logger:JsonLogger
        <<: *experiment_info
    # Log configuration and metrics to Tensorboard file
    - !callable:aiws.tb_logger:TBLogger
        args: [ *summary_writer ]
        kwargs:
            <<: *experiment_info
<< endblock callback_list