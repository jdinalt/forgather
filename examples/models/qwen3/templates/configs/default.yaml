-- extends "projects/causal_lm_def.yaml"

[config_metadata]
    == super()
    -- set ns.config_name = "Default Qwen3"
    -- set ns.config_description = "Qwen3 8B"
    -- set ns.model_name = model_name | default("qwen_8b")

[model_definition]
    -- include "config.default.model"

#------------- config.default.model --------------
-- extends "models/transformers/dynamic_llama.yaml"

[model_meta_config]
    == super()
    -- set ns.model_name = ns.config_name
    -- set ns.model_description = ns.config_description
    -- set ns.model_short_name = "qwen3"

[model_tokenizer]
tokenizer: &tokenizer !singleton:transformers:AutoTokenizer.from_pretrained@tokenizer
    arg0: {{ tokenizer_id_or_path | toyaml('Qwen/Qwen3-8B') }}
    model_max_length: {{ max_model_length | toyaml(32768) }}

[qk_norm_factory]
.define: &qk_norm_factory !partial:torch.nn:RMSNorm@qk_norm_factory
    eps: !var "rms_norm_eps"

[model_config]
    == super()
    # **Qwen3 Defaults (8B)**
    hidden_size: {{ hidden_size | toyaml(4096) }}
    num_attention_heads: {{ num_attention_heads | toyaml(32) }}
    num_key_value_heads: {{ num_key_value_heads | toyaml(8) }}
    num_hidden_layers: {{ num_hidden_layers | toyaml(36) }}
    intermediate_size: {{ intermediate_size | toyaml(12288) }}
    rope_theta: {{ rope_theta | toyaml(1000000.0) }}
    rms_norm_eps: {{ rms_norm_eps | toyaml(1.0e-06) }}

