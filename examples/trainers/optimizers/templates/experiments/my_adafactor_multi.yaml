-- extends 'project.yaml'

-- block config_metadata
    == super()
    -- set ns.config_name = "My Adafactor Multioptim"
    -- set ns.config_description = "My Adafactor implementation with adam for 1d tensors"
    -- set ns.log_name = "my_adafactor_multi"
-- endblock config_metadata

-- block optimizer
.define: &optimizer !lambda:./src/multiopt.py:make_re_multiopt
    optimizer_map:
        - [ "bias", "default" ]
        - [ "output_decoder|input_encoder|feedforward|attention", "adafactor" ]
        - [ ".*", "default" ]
    factories:
        adafactor: !lambda:./src/adafactor.py:Adafactor
            lr: 1.0e-3
        default: !lambda:./src/adam.py:Adam
            lr: 3.0

<< endblock optimizer