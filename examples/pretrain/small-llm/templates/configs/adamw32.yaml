-- extends 'project.yaml'

[config_metadata]
    == super()
    -- set ns.config_name = "AdamW32"
    -- set ns.config_description = "Train in full float32 with AdamW"
    -- set ns.model_name = "adamw32"

[trainer_args]
    == super()
    float32_matmul_precision: "high"
    default_dtype: "float32"

    # Always compile
    torch_compile: True
    torch_compile_dynamic: True

[optimizer]
optimizer: &optimizer !partial:torch.optim:AdamW
    lr: {{ (ns.base_learning_rate * ns.lr_scale) | toyaml }}
