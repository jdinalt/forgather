-- extends 'project.yaml'

## This modifies the baseline project to use the pipeline trainer,
## rather than the single-gpu trainer. We try to keep the changes
## to a minimum for comparative purposes.

## This configuration assumes the model has 16 stages and will run on two
## GPU's, thus we split at the end of layer-7. For other configurations,
## modify the split-spec to have roughly and equal quantity of weights
## on each GPU.
[config_metadata]
    == super()
    -- set ns.config_name = "Base Pipeline Project"
    -- set ns.config_description = ""
    -- set ns.log_name = "pipeline_defaults"
    ## Change the trainer implementation.
    -- set ns.trainer_class = 'trainers/pipeline_trainer.yaml'

[trainer_definition]
    -- include 'base_pipeline_project.trainer_config'

[load_model]
    -- include 'models/causal_lm/from_pretrained_config.yaml'

#-------------------- base_pipeline_project.trainer_config --------------------
-- extends 'project.trainer_config'

[trainer_args]
    == super()
    # Debug settings -- for quick access
    debug_pipeline: False
    debug_split_model: False
    debug_model_params: False
    debug_model_init: False
