## The project defines the defaults
-- extends 'configs/custom_model.yaml'

[config_metadata]
    == super()
    ## Experiment Metadata
    -- set ns.config_name = 'ALiBi Attention'
    -- set ns.config_description = "https://arxiv.org/abs/2108.12409"
    -- set ns.model_name = 'alibi_model'
    -- set ns.log_name = "experiment"

## Override default project definition
[construct_new_model]
    -- include 'alibi_attention.model_config'

#-------------------- alibi_attention.model_config --------------------
## Override base custom_model
-- extends 'custom_model.model_config'

[positional_encoder]
# Disable default positional encoder
positional_encoder: &positional_encoder null

[attention_factory]
# Switch to using ALiBi attention!
attention_factory: &attention_factory !partial:.causal_alibi_attn:CausalAlibiAttn@attention_factory
    d_model: !var "hidden_size"
    num_heads: !var "num_attention_heads"
    dropout: !var "attention_dropout"
    bias: False
    # Make the alibi biases trainable weights.
    trainable_alibi: True