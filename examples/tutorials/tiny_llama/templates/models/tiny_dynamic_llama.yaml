-- extends 'models/transformers/dynamic_llama.yaml'

[model_tokenizer]
tokenizer: &tokenizer !call:forgather:from_project
    project_dir: "{{ joinpath(ns.forgather_dir, 'examples', 'tokenizers', 'tiny_stories_bpe') }}"
    config_template: "2k.yaml"

## Make the model much smaller.
[model_config]
    == super()
    # Tiny Llama overrides
    hidden_size: 256
    dim_feedforward: 1024
    num_attention_heads: 2
    num_hidden_layers: 4
    d_head: 128 # Must be hidden_size // num_attention_heads
