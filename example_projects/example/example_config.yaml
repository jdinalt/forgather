-- import 'common/trainer/accel_trainer.yaml' as accel_trainer
-- set experiment = namespace()
-- include 'project/defaults.yaml'
-- import 'models/attention_only/attnonly.yaml' as model_def
-- set experiment.DATASET = "tiny_stories_tokenized"
-- set experiment.EXPERIMENT_NAME = "My Experiment"
-- set experiment.EXPERIMENT_DESCRIPTION = "Long experiment description with more info"
-- set experiment.MODEL_NAME = "my_model"
-- set experiment.CREATE_NEW_MODEL = True
-- set experiment.SAVE_MODEL = True

-- set experiment.MODEL_CONFIG
{{ model_def.CONFIG }}
-- endset
-- set experiment.model = model_def.model
-- set experiment.tokenizer = model_def.tokenizer

-- set experiment.TRAINING_ARGS
{{ experiment.TRAINING_ARGS }}
    overwrite_output_dir: True
    per_device_train_batch_size: 128
    per_device_eval_batch_size: 128
    max_steps: 1500
    eval_steps: 250
    logging_steps: 100
-- endset

-- set experiment.TRAINER
{{ accel_trainer.trainer() }}
-- endset

-- include 'common/causal_lm/base_train.yaml'