## Given a model-id or a path to a model, construct the model
## and load the weight, using AutoModelForCausalLM.from_pretrained()
-- extends 'models/base_language_model.yaml'

[model_meta_config]
    == super()
    -- set ns.model_name = "Pretrained Causal LM"
    -- set ns.model_description = ""
    -- set ns.model_id_or_path = ns.model_id_or_path

[model_header]
    == super()
# ns.model_id_or_path = "{{ ns.model_id_or_path }}"

[model_tokenizer]
tokenizer: &tokenizer !call:transformers:AutoTokenizer.from_pretrained@tokenizer
    arg0: "{{ ns.model_id_or_path }}"

[model_constructor]
model: &model !partial:transformers:AutoModelForCausalLM.from_pretrained@model
    arg0: "{{ ns.model_id_or_path }}"
    -- if ns.trust_remote_code
    trust_remote_code: True
    -- endif
    <<: *model_constructor_args